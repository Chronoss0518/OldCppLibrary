
#include<Windows.h>
#include"../../BaseIncluder/ChBase.h"
#include"../../BaseIncluder/ChD3D9I.h"

#include"ChLight9.h"

///////////////////////////////////////////////////////////////////////////////////////
//ChLight9メソッド
///////////////////////////////////////////////////////////////////////////////////////

ChLight9::ChLight9(LPDIRECT3DDEVICE9 _Dv) 
{
	Device = _Dv;
	Device->SetRenderState(D3DRS_LIGHTING, TRUE);

	///////////////////////////////////////////////////////////////////////////////////////
	//TypeSet(光源の種類)

	Light.Type = D3DLIGHT_DIRECTIONAL;

	///////////////////////////////////////////////////////////////////////////////////////
	//DirectionSet(ライトの角度)

	Light.Direction = D3DXVECTOR3(1.0f, -1.0f, 0.0f);

	///////////////////////////////////////////////////////////////////////////////////
	//Position(lightの位置)

	SetPos(&D3DXVECTOR3(0.0f, 0.0f, 0.0f));

	///////////////////////////////////////////////////////////////////////////////////////
	//DiffuserSet(光源色)

	SetLightDif(1.0f, 1.0f, 1.0f, 1.0f);

	///////////////////////////////////////////////////////////////////////////////////////
	//SpecularSet(光沢効果)
	SetLightSpe(FALSE, 1.0f, 1.0f, 1.0f);

	///////////////////////////////////////////////////////////////////////////////////////
	//AmbientSet(環境光効果)

	SetLightAmb(FALSE, 1.0f, 1.0f, 1.0f);

	///////////////////////////////////////////////////////////////////////////////////////
	//RegisterLight

	Device->SetLight(0, &Light);
	Device->LightEnable(0, TRUE);

	///////////////////////////////////////////////////////////////////////////////////////
	//RangeSet(ライトの範囲)

	Light.Range = 25.0f;

	///////////////////////////////////////////////////////////////////////////////////////
	//AttenuatSet(長距離へ行った時のライトの強さ計算)

	Light.Attenuation0 = 0.0f;
	Light.Attenuation1 = 0.2f;
	Light.Attenuation2 = 0.0f;

	///////////////////////////////////////////////////////////////////////////////////////
	//PositionSet(Point,SpotLight時のライトの位置)

	Light.Position = D3DXVECTOR3(0.0f, 0.0f, 0.0f);


}

///////////////////////////////////////////////////////////////////////////////////

	//Lightを使用するかしないかの設定
void ChLight9::SetLight(bool Flg)
{
	Device->LightEnable(0, TRUE);
}

///////////////////////////////////////////////////////////////////////////////////

//Lightの角度の設定
void ChLight9::SetDir(const ChVec3_9& _Dir)
{
	ChVec3_9 TmpVec = _Dir;
	TmpVec.Normalize();
	Light.Direction = TmpVec;
	RegisterLight();
}

///////////////////////////////////////////////////////////////////////////////////

void ChLight9::SetPos(const D3DXVECTOR3 *_Pos)
{
	Light.Position = *_Pos;
}


///////////////////////////////////////////////////////////////////////////////////

//Lightの光源色のセット
void ChLight9::SetLightDif(const float _a, const float _r, const float _g, const float _b)
{
	Light.Diffuse.a = _a;
	Light.Diffuse.r = _r;
	Light.Diffuse.g = _g;
	Light.Diffuse.b = _b;
	RegisterLight();
}

///////////////////////////////////////////////////////////////////////////////////

//Lightの光沢効果のセット
void ChLight9::SetLightSpe(bool _SpeFlg, const float _r, const float _g, const float _b)
{
	Device->SetRenderState(D3DRS_SPECULARENABLE, _SpeFlg);
	Light.Specular.r = _r;
	Light.Specular.g = _g;
	Light.Specular.b = _b;
	RegisterLight();
}

///////////////////////////////////////////////////////////////////////////////////

//Lightの光沢効果のセット
void ChLight9::SetLightAmb(bool _AmbFlg, const float _r, const float _g, const float _b)
{
	Device->SetRenderState(D3DRS_AMBIENT, _AmbFlg);
	Light.Ambient.r = _r;
	Light.Ambient.g = _g;
	Light.Ambient.b = _b;
	RegisterLight();
}

///////////////////////////////////////////////////////////////////////////////////

void ChLight9::RegisterLight()
{
	Device->SetLight(0, &Light);
}
